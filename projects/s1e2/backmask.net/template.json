{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Transform": "AWS::Serverless-2016-10-31",
  "Description": "An AWS Serverless Application to backmask, or reverse the audio version, of a piece of text. This template is partially managed by Amazon.Lambda.Annotations (v0.12.0.0).",
  "Globals": {
    "Function": {
      "Timeout": 30,
      "MemorySize": 256
    }
  },
  "Resources": {
    "FFMPEGLayer": {
      "Type": "AWS::Serverless::LayerVersion",
      "Properties": {
        "CompatibleArchitectures": [
          "x86_64"
        ],
        "LayerName": "ffmpeg-bin",
        "Description": "ffmpeg dependencies for backmask.net function",
        "ContentUri": "dependencies/",
        "CompatibleRuntimes": [
          "dotnet6"
        ],
        "LicenseInfo": "https://ffmpeg.org/legal.html"
      }
    },
    "BackmaskFunctionsCreateBackmaskGenerated": {
      "Type": "AWS::Serverless::Function",
      "Metadata": {
        "Tool": "Amazon.Lambda.Annotations",
        "SyncedEvents": [
          "RootPost"
        ]
      },
      "Properties": {
        "Runtime": "dotnet6",
        "CodeUri": "function",
        "Layers": [
          {
            "Ref": "FFMPEGLayer"
          }
        ],
        "Policies": [
          "AWSLambdaBasicExecutionRole",
          {
            "Version": "2012-10-17",
            "Statement": {
              "Effect": "Allow",
              "Action": [
                "polly:SynthesizeSpeech"
              ],
              "Resource": "*"
            }
          }
        ],
        "PackageType": "Zip",
        "Handler": "backmask::Backmask.Functions_CreateBackmask_Generated::CreateBackmask",
        "Events": {
          "RootPost": {
            "Type": "HttpApi",
            "Properties": {
              "Path": "/backmask",
              "Method": "POST"
            }
          }
        }
      }
    }
  },
  "Outputs": {
    "BackmaskApi": {
      "Description": "API Gateway endpoint URL for CreateBackmask Lambda function",
      "Value": {
        "Fn::Sub": "https://${ServerlessHttpApi}.execute-api.${AWS::Region}.amazonaws.com/backmask"
      }
    }
  }
}